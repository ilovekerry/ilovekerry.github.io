<app-content-title title="exportable table"></app-content-title>
<app-card cardTitle="FileSaver" cardIntroduction="FileSaver.js is the solution to saving files on the client-side, and is perfect for webapps that need to generate files, or for saving sensitive information that shouldn't be sent to an external server.">
  <div class="export-container">
    <mat-form-field>
      <input matInput placeholder="请输入文件名" [(ngModel)]="fileName">
    </mat-form-field>
    <div class="button-row">
      <button mat-raised-button color="primary" (click)="exportTable()">导出</button>
    </div>
  </div>
  <div id="exportableTable" class="hidden-table">
<table>
  <thead>
  <tr>
    <th *ngFor="let item of tableTitle">{{item}}</th>
  </tr>
  </thead>
  <tbody>
  <tr *ngFor="let item of tableData">
    <td *ngFor="let title of titleArr">{{item[title]}}</td>
  </tr>
  </tbody>
</table>
</div>
<mat-table [dataSource]="tableData">
  <ng-container matColumnDef="id">
    <mat-header-cell *matHeaderCellDef> ID </mat-header-cell>
    <mat-cell *matCellDef="let item"> {{item.id}} </mat-cell>
  </ng-container>
  <ng-container matColumnDef="name">
    <mat-header-cell *matHeaderCellDef> Name </mat-header-cell>
    <mat-cell *matCellDef="let item"> {{item.name}} </mat-cell>
  </ng-container>
  <ng-container matColumnDef="email">
    <mat-header-cell *matHeaderCellDef> email </mat-header-cell>
    <mat-cell *matCellDef="let item"> {{item.email}} </mat-cell>
  </ng-container>
  <ng-container matColumnDef="username">
    <mat-header-cell *matHeaderCellDef> username </mat-header-cell>
    <mat-cell *matCellDef="let item"> {{item.username}} </mat-cell>
  </ng-container>
  <ng-container matColumnDef="contact">
    <mat-header-cell *matHeaderCellDef> contact </mat-header-cell>
    <mat-cell *matCellDef="let item"> {{item.contact}} </mat-cell>
  </ng-container>
  <mat-header-row *matHeaderRowDef="titleArr"></mat-header-row>
  <mat-row *matRowDef="let row; columns: titleArr;"></mat-row>
</mat-table>
</app-card>
